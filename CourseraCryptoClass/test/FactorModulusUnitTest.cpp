#include "gtest/gtest.h"
#include "FactorModulus.h"

using namespace testing;

TEST(FactorModulusUnitTest, 1)
{
        mpz_class N("1797693134862315907729305190789024733617976978942306572734300811577326758055056206869853794492129829595855013875371640157101398586\
        	     4783377860692558349754108519659161512805757594075263500747593528871082364994994077189561705436114947486504671101510156394068052754\
		     0071584560878577663743040086340742855278549092581");
        auto factros = factorModulus(N);
        mpz_class factoredN;
        mpz_mul(factoredN.get_mpz_t(), factros.first.get_mpz_t(), factros.second.get_mpz_t());
        EXPECT_EQ(N, factoredN); // checking that N = p * q;

        EXPECT_EQ(mpz_class("134078079299425970995740249982058461274793658205923933777235614437217640300\
                             73662768891111614362326998675040546094339320838419523375986027530441562135724301"), factros.first);
}
